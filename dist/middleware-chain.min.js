!function(a,b){if("function"==typeof define&&define.amd)define(["lodash"],b);else if("undefined"!=typeof module&&module.exports)module.exports=b(require("lodash"));else{var c=this,d=b(c._),e=c[a];d.noConflict=function(){return c[a]=e,d},c[a]=d}}("Chain",function(a){var b=function(){this.chain=[],this.errorChain=[]},c=function(a){4===a.length?this.errorChain.push(a):this.chain.push(a)};return b.prototype.use=function(){var b=this;return a.each(arguments,function(d){a.isFunction(d)?c.call(b,d):a.isArray(d)&&a.each(d,function(a){c.call(b,a)})}),this},b.prototype.handle=function(a,b){var c=0,d=0,e=this.chain,f=function(e,f){var h;e===this.chain?(h=e[c++])&&h(a,b,g):e===this.errorChain&&(h=e[d++])&&h(f,a,b,g)}.bind(this),g=function(a){a instanceof Error&&(e=this.errorChain),f(e,a)}.bind(this);g()},b});